<span class="flex flex-row items-center">
  @if (currentView === 'PROJECT' && currentProject !== null && currentUnit.currentUserIsStaff) {
    <mat-icon class="f-breadcrumb">chevron_right</mat-icon>
    <button #menuState="matMenuTrigger" mat-button [matMenuTriggerFor]="menu">
      <span class="flex items-center flex-row">
        <span> Staff Tasks </span>
        <mat-icon>{{ menuState.menuOpen ? 'arrow_drop_up' : 'arrow_drop_down' }} </mat-icon>
      </span>
    </button>
    <mat-menu #menu="matMenu">
      <button mat-menu-item uiSref="units/tasks/inbox" [uiParams]="{unitId: currentUnit.id}">
        <mat-icon aria-label="Inbox icon" fontIcon="inbox"></mat-icon> <span>Inbox</span>
      </button>
      <button mat-menu-item uiSref="units/tasks/definition" [uiParams]="{unitId: currentUnit.id}">
        <mat-icon aria-label="Task Explorer Icon" fontIcon="pageview"></mat-icon> Explorer
      </button>
      <button mat-menu-item uiSref="units/tasks/viewer" [uiParams]="{unitId: currentUnit.id}">
        <mat-icon aria-label="Task list icon" fontIcon="list_alt"></mat-icon> Tasks
      </button>
      <mat-divider></mat-divider>
      <button mat-menu-item uiSref="units/students/list" [uiParams]="{unitId: currentUnit.id}">
        <mat-icon aria-label="Students list" fontIcon="group"></mat-icon> Students
      </button>
      <button mat-menu-item uiSref="units/students/groups" [uiParams]="{unitId: currentUnit.id}">
        <mat-icon aria-label="Student Groups" fontIcon="groups"></mat-icon> Groups
      </button>
      <button
        mat-menu-item
        uiSref="units/students/portfolios"
        [uiParams]="{unitId: currentUnit.id}"
      >
        <mat-icon aria-label="Student portfolios icon" fontIcon="collections_bookmark"></mat-icon>
        Portfolios
      </button>
      <span>
        <mat-divider></mat-divider>
        <button mat-menu-item uiSref="units/analytics" [uiParams]="{unitId: currentUnit.id}">
          <mat-icon aria-label="Unit Analytics icon" fontIcon="insights"></mat-icon>Analytics
        </button>
        @if (currentUnit.currentUserIsConvenor) {
          <button mat-menu-item uiSref="units/admin" [uiParams]="{unitId: currentUnit.id}">
            <mat-icon aria-label="Unit Administration" fontIcon="admin_panel_settings"></mat-icon>
            Administration
          </button>
        }
      </span>
    </mat-menu>
  }
  @if (currentActivity) {
    <mat-icon class="f-breadcrumb">chevron_right</mat-icon>
    <button mat-button [matMenuTriggerFor]="menu2" #menuState="matMenuTrigger">
      <span class="flex items-center flex-row">
        <span>{{ menuText }}</span>
        <mat-icon>{{ menuState.menuOpen ? 'arrow_drop_up' : 'arrow_drop_down' }} </mat-icon>
      </span>
    </button>
    <mat-menu #menu2="matMenu">
      @if (currentProject !== null && currentView === 'PROJECT') {
        <button
          uiSref="projects/dashboard"
          [uiParams]="{projectId: currentProject.id, taskAbbr: ''}"
          mat-menu-item
        >
          <mat-icon aria-label="Dashboard icon" fontIcon="dashboard"></mat-icon> Dashboard
        </button>
        <mat-divider></mat-divider>
        <button
          uiSref="projects/outcomes"
          [uiParams]="{projectId: currentProject.id, taskAbbr: ''}"
          mat-menu-item
        >
          <mat-icon aria-label="learning outcomes icon" fontIcon="flag"></mat-icon> Learning
          Outcomes
        </button>
        <button
          uiSref="projects/portfolio"
          [uiParams]="{projectId: currentProject.id, taskAbbr: ''}"
          mat-menu-item
        >
          <mat-icon aria-label="Portfolio creation icon" fontIcon="auto_stories"></mat-icon>
          Portfolio Creation
        </button>
        <mat-divider></mat-divider>
        <button
          uiSref="projects/groups"
          [uiParams]="{projectId: currentProject.id, taskAbbr: ''}"
          mat-menu-item
        >
          <mat-icon aria-label="Groups list icon" fontIcon="groups"></mat-icon> Groups List
        </button>
        <button
          uiSref="projects/tutorials"
          [uiParams]="{projectId: currentProject.id, taskAbbr: ''}"
          mat-menu-item
        >
          <mat-icon aria-label="Tutorial List icon" fontIcon="meeting_room"></mat-icon> Tutorial
          List
        </button>
      }
      @if (unitRole && currentView === 'UNIT') {
        <!-- <p class="task-dropdown-heading">Tasks</p> -->
        @if (unitRole.role !== 'Admin') {
          <button uiSref="units/tasks/inbox" [uiParams]="{unitId: unitRole.unit.id}" mat-menu-item>
            <mat-icon aria-label="Inbox icon" fontIcon="inbox"></mat-icon> <span>Inbox</span>
          </button>
        }
        @if (unitRole.role !== 'Admin') {
          <button
            uiSref="units/tasks/definition"
            [uiParams]="{unitId: unitRole.unit.id}"
            mat-menu-item
          >
            <mat-icon aria-label="Task Explorer Icon" fontIcon="pageview"></mat-icon> Explorer
          </button>
        }
        @if (unitRole.role !== 'Admin') {
          <button uiSref="units/tasks/viewer" [uiParams]="{unitId: unitRole.unit.id}" mat-menu-item>
            <mat-icon aria-label="Task list icon" fontIcon="list_alt"></mat-icon> Tasks
          </button>
        }
        @if (unitRole.role !== 'Admin') {
          <mat-divider></mat-divider>
        }
        <!-- <p class="task-dropdown-heading">Students</p> -->
        @if (unitRole.role !== 'Admin') {
          <button
            uiSref="units/students/list"
            [uiParams]="{unitId: unitRole.unit.id}"
            mat-menu-item
          >
            <mat-icon aria-label="Students list" fontIcon="group"></mat-icon> Students
          </button>
        }
        @if (unitRole.role !== 'Admin') {
          <button
            uiSref="units/students/groups"
            [uiParams]="{unitId: unitRole.unit.id}"
            mat-menu-item
          >
            <mat-icon aria-label="Student Groups" fontIcon="groups"></mat-icon> Groups
          </button>
        }
        @if (unitRole.role !== 'Admin') {
          <button
            uiSref="units/students/portfolios"
            [uiParams]="{unitId: unitRole.unit.id}"
            mat-menu-item
          >
            <mat-icon
              aria-label="Student portfolios icon"
              fontIcon="collections_bookmark"
            ></mat-icon>
            Portfolios
          </button>
        }
        @if (unitRole.role !== 'Admin') {
          <mat-divider></mat-divider>
        }
        <!-- <p class="task-dropdown-heading">Unit</p> -->
        @if (unitRole.role !== 'Admin') {
          <button uiSref="units/analytics" [uiParams]="{unitId: unitRole.unit.id}" mat-menu-item>
            <mat-icon aria-label="Unit Analytics icon" fontIcon="insights"></mat-icon>Analytics
          </button>
        }
        @if (unitRole.role === 'Convenor' || unitRole.role === 'Admin') {
          <button uiSref="units/admin" [uiParams]="{unitId: unitRole.unit.id}" mat-menu-item>
            <mat-icon aria-label="Unit Administration" fontIcon="admin_panel_settings"></mat-icon>
            Administration
          </button>
        }
      }
    </mat-menu>
  }
</span>
